window.onload = function() {
    document.getElementById("audio").play();
}

/*PORTRAIT URLS*/
/*TORI*/
var happyTor = "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/tor/happyTor_zps1d033488.png";
var normTor = "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/tor/normTor_zps0a03b416.png";
var sadTor = "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/tor/sadTor_zps54ff3f1c.png";
var scaredTor = "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/tor/scaredTor_zps1972c5a0.png";
var seriousTor = "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/tor/seriousTor_zpsef5d5b9e.png";
var worriedTor = "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/tor/worriedTor_zps96e7d187.png";
/*VIC*/
var asideVic = "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/vic/asideVic_zps2db20ea7.png";
var normVic = "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/vic/normVic_zps14fc897e.png";
var happyVic = "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/vic/happyVic_zpseabfa03d.png";
//do not use sad until changed
var sadVic = "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/vic/sadVic_zpsf1222fe5.png";
var worriedVic = "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/vic/worriedVic_zpsa93c0abf.png";
var yellVic = "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/vic/yellVic_zpsd2cb795c.png";
var scaredVic = "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/vic/scaredVic_zpsffb3b70c.png";
var smileVic = "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/vic/smileVic_zps62990f4b.png";

var page = new Array();
page.push(
    {
        type: 0,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "Wow. What a festival, huh, Vicky?",
        pdirection: [
            {position: 2, url: happyTor},
        ]
    }
);
page.push(
    {
        type: 0,
        nameText: "Victor",
        nColor: "#225d33",
        text: "U-ugh. Please don't talk to me about it. We got pranked more times than I'd care for.",
        pdirection: [
            {position: 4, url: worriedVic}
        ]
    }
);
page.push(
    {
        type: 0,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "But, hey. Things went way better than last time, huh?",
        pdirection: [
            {position: 2, url: normTor},
        ]
    }
);
page.push(
    {
        type: 0,
        nameText: "Victor",
        nColor: "#225d33",
        text: "Yeah.",
        pdirection: [
            {position: 4, url: smileVic}
        ]
    }
);
page.push(
    {
        type: 0,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "...",
        pdirection: [
            {position: 2, url: sadTor},
        ]
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "V-Victor... About the last time...I-I'm sorry for laughing at you when you confessed your love to me.",
    }
);
page.push(
    {
        type: 0,
        nameText: "Victor",
        nColor: "#225d33",
        text: "It's...It's no problem. I've...I've...",
        pdirection: [
            {position: 4, url: worriedVic}
        ]
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "And then not even giving you a proper reason for why I turned you down...",
    }
);
page.push(
    {
        type: 1,
        nameText: "Victor",
        nColor: "#225d33",
        text: "I-I've put th-that-",
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "And I didn't even tell you why when we got together.",
    }
);
page.push(
    {
        type: 0,
        nameText: "Victor",
        nColor: "#225d33",
        text: "Victoria, stop!",
        pdirection: [
            {position: 4, url: yellVic}
        ]
    }
);
page.push(
    {
        type: 0,
        nameText: "Victor",
        nColor: "#225d33",
        text: "Please don't say anymore.",
        pdirection: [
            {position: 4, url: worriedVic}
        ]
    }
);
page.push(
    {
        type: 1,
        nameText: "Victor",
        nColor: "#225d33",
        text: "It-It hurts...It hurts to remember these things...alright? I want to f-focus on how g-good things are now...and forget the past.",
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "But you can't forget the past. And I can't take back my actions, no matter what I do.",
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "So I want to clear up the past for you. And change your memory so that your past doesn't hurt you anymore.",
    }
);
/*portrait change, plsss*/
page.push(
    {
        type: -1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "...I believed everything my Dad taught me when I was young. He told me that the weak were worthless-that they'd only drag me down.",
        pdirection: [
            {position: 2, url: ""},
            {position: 4, url: ""}
        ],
        bg: "",
        effectbg: "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/bgs/avpfffpast1_zps6cef652c.png"
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "As I grew up, I started to realize that that didn't make any sense. No one's really 'weak.' Everyone has their own strengths and weaknesses in different places.",
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "You taught me this, Victor.",
    }
);
/*Victor sceeene*/
page.push(
    {
        type: -1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "Living with you, seeing your moments of weakness...but then your glorious moments of strength.",
        pdirection: [],
        bg: "",
        effectbg: "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/bgs/avpfffpast2_zps02e160b6.png"
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "I fell for you so long ago.",
    }
);
page.push(
    {
        type: -1,
        nameText: "Victor",
        nColor: "#225d33",
        text: "V-Victoria...I-I'm...s-so happy. B-but so confused... Why did you hide this from me?",
        pdirection: [
            {position: 2, url: sadTor},
            {position: 4, url: worriedVic}
        ],
        bg: "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/tor/avpfffBG_zpscc23f996.png",
        effectbg: ""
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "Because even though you showed me that Dad was wrong-I still cared deeply for Dad."
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "I didn't want to upset him-"
    }
);
page.push(
    {
        type: 1,
        nameText: "Victor",
        nColor: "#225d33",
        text: "B-but, you didn't know if he was even alive after you pushed him off the cliff-"
    }
);
page.push(
    {
        type: 0,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "But he could have been!",
        pdirection: [
            {position: 2, url: worriedTor}
        ]
    }
);
page.push(
    {
        type: 0,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "It's-ugh-it's hard to explain.",
        pdirection: [
            {position: 2, url: sadTor}
        ]
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "Every little thing mattered to me, you know?"
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "If I didn't believe in him anymore...he was that much more dead to me."
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "I wanted him to be alive so, so badly-I was willing to give up so much."
    }
);
page.push(
    {
        type: 1,
        nameText: "Victor",
        nColor: "#225d33",
        text: "Victoria. I didn't think you were the type to live for others."
    }
);
page.push(
    {
        type: 0,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "Was that really what I was doing? I live for helping others. Nothing in the whole world gives me more happiness than that.",
        pdirection: [
            {position: 2, url: seriousTor}
        ]
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "But it was a difficult time.",
    }
);
page.push(
    {
        type: 0,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "I was confused about everything. I wasn't sure if Dad was alive. Whether his weird justice ideas were right. I wasn't even sure  what your parents would think.",
        pdirection: [
            {position: 2, url: worriedTor}
        ]
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "It was stressful, so I just... I messed up. And hurt you.",
    }
);
page.push(
    {
        type: 1,
        nameText: "Victor",
        nColor: "#225d33",
        text: "It's alright...Uhm, sorry, Victoria, but this isn't making these memories any easier for me-",
    }
);
page.push(
    {
        type: 0,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "I'm not done yet-gimme a second, Victor.",
        pdirection: [
            {position: 2, url: seriousTor}
        ]
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "Dad came back, and you two fought.",
    }
);
page.push(
    {
        type: 0,
        nameText: "Victor",
        nColor: "#225d33",
        text: "...He was going to kill me.",
        pdirection: [
            {position: 4, url: asideVic}
        ]
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "No, he wasn't.",
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "Because I would have killed him, first.",
    }
);
page.push(
    {
        type: 0,
        nameText: "Victor",
        nColor: "#225d33",
        text: "...I bring out the worst in you...",
        pdirection: [
            {position: 4, url: scaredVic}
        ]
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "No. I wanted to speak his language. Justice and eye-for-an-eye or whatever-I needed to send him the message that he can't kill you-immediately.",
    }
);
page.push(
    {
        type: 0,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "Dad... I love him so much, and he tried so hard to teach me how to be good.",
        pdirection: [
            {position: 2, url: sadTor},
            {position: 4, url: worriedVic}
        ]
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "But I realized that if he brings out a side of me that wants to kill... then I had to grow up and help him instead of desperately following him.",
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "Dad was sick in the mind, you know...his own parents mistreated him.",
    }
);
page.push(
    {
        type: 1,
        nameText: "Victor",
        nColor: "#225d33",
        text: "O-oh... I'm sorry.",
    }
);
page.push(
    {
        type: 0,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "Hey. Don't be. You were the one who got me to realize all this, silly.",
        pdirection: [
            {position: 2, url: normTor}
        ]
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "You're the guy who finally pulled us out of our funk, and let us finally start enjoying life. And you waited for me to tell you this after all these years."
    }
);
page.push(
    {
        type: 1,
        nameText: "Victor",
        nColor: "#225d33",
        text: "Uhm...it-it still kinda hurts to remember some of this stuff, though... especially since now that I know how much you were suffering..."
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "But I got stronger out of it. Dad and I both did!"
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "You helped us become the great guys we are today, Victor."
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "Even if it hurts to remember the past, remember that it led up to this beautiful present."
        
    }
);
page.push(
    {
        type: -1,
        nameText: "Victor",
        nColor: "#225d33",
        text: "Haha-but all I care about is spending the future with you.",
        pdirection: [
            {position: 2, url: ""},
            {position: 4, url: ""}
        ],
        bg: "http://i1141.photobucket.com/albums/n588/mymaryyn/avpSkits/bgs/avpfffcut_zps7e590ac8.png",
        effectbg: ""
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "Don't get all cheesy, you cheeky cutey, you. Hey, all my yammering tonight let up some of that pain, right?"
    }
);
page.push(
    {
        type: 1,
        nameText: "Victor",
        nColor: "#225d33",
        text: "A bit. And that's plenty."
    }
);
page.push(
    {
        type: 1,
        nameText: "Victor",
        nColor: "#225d33",
        text: "You feel better, too?"
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "Yeah...Yes."
    }
);
page.push(
    {
        type: 1,
        nameText: "Victoria",
        nColor: "#bd3899",
        text: "Thanks, Beloved."
    }
);
page.push(
    {
        type: 1,
        nameText: "",
        nColor: "#bd3899",
        text: "The End: Thanks for viewing!"
    }
);
//Starts at -1 to consider count being placed before loading pg
var count = -1;
/*
    lpc = Last Portrait Changed
    When going backward, to ensure that portraits
    are properly updated, we need to know when was the
    last time a portrait updated; The page count will
    be stored in the portrait's respective place in
    the lpc array. -1 means the portrait has not been
    touched.
*/
var lpc = [-1,-1,-1,-1,-1]

/*START FUNCTIONS*/
function nextText() {
    if(count < page.length - 1) {
        count = count + 1;
        loadPage(count);
    }    
}

function backText() {
    if(count > -1 && count < page.length) {
        count = count - 1;
        resetPage(count, count + 1);
        loadPage(count);
    }  
}

/*id must be a string
source is the string of the new portait*/
function changePortrait (id, source) {
    
   $(id).fadeOut(100, function(){
      $(this).attr('src', source).bind('onreadystatechange load', function(){
         if (this.complete) $(this).fadeIn(100);
      });
   });
}

function loadPage(count) {
    var pg, pdp;
    //pg is page itself
    //pdp stores portrait changes
    var nam = document.getElementById("nametext");
    var txt = document.getElementById("textbg");
    var ebg = document.getElementById("effectBG");
    
    pg = page[count];
    switch(pg.type) {
        case -1: //effectbg (used for cutscenes out of scene)
            if(pg.effectbg != "") {
                changePortrait("#effectBG", pg.effectbg);
            } else {
                fadeOut.call($("#effectBG"));
            }
            if(pg.bg != "") {
                changePortrait("#bg", pg.bg);
            } else {
                fadeOut.call($("#bg"));
            }
        case 0: //portrait changes
            for(i = 0; i < pg.pdirection.length; i++) {
                pdp = pg.pdirection[i].position;
                //5 positions: left, center, right
                // left-pair, right-pair
                switch(pg.pdirection[i].position) {
                    case 1:
                        break;
                    case 2:
                        changePortrait("#leftPortraitPair", pg.pdirection[i].url);
                        lpc[1] = count;
                        break;
                    case 3:
                        changePortrait("#centerPortrait", pg.pdirection[i].url);
                        lpc[2] = count;
                        break;
                    case 4:
                        changePortrait("#rightPortraitPair", pg.pdirection[i].url);
                        lpc[3] = count;
                        break;
                    case 5:
                        break;
                    default:
                }

            }
            //break; let the portait change continue into txt change
        case 1: //text change
            nam.innerHTML = pg.nameText;
            nam.style.color = pg.nColor;
            txt.innerHTML = pg.text;
            break;
        default:
    }
}

function resetPage(back, forward) {

    var pg, pdp;
    var nam = document.getElementById("nametext");
    var txt = document.getElementById("textbg");
    var ebg = document.getElementById("effectBG");
    
    pg = page[back];
    switch(pg.type) {
        case -1: //effectbg (used for cutscenes out of scene)
            if(pg.effectbg != "") {
                changePortrait("#effectBG", pg.effectbg);
            } else {
                fadeOut.call($("#effectBG"));
            }
            if(pg.bg != "") {
                changePortrait("#bg", pg.bg);
            } else {
                fadeOut.call($("#bg"));
            }
        case 0: //portrait changes
            //check which portrait has been changed
            var portraitpg;
            for(i = 0; i < lpc.length; i++) {
                if(lpc[i] != -1) {
                    portraitpg = page[lpc[i]];
                    switch(i + 1) {
                    case 1:
                        break;
                    case 2:
                        changePortrait("#leftPortraitPair", portraitpg.pdirection[i].url);
                        break;
                    case 3:
                        changePortrait("#centerPortrait", portraitpg.pdirection[i].url);
                        break;
                    case 4:
                        changePortrait("#rightPortraitPair", portraitpg.pdirection[i].url);
                        break;
                    case 5:
                        break;
                    default:
                }
                }
            }            
            
            //break; let the portait change continue into txt change
        case 1: //text change
            break;

}

/*Fade in and out both only accept id tags
eg: fadeIn.call($("#myImage"));*/
function fadeIn()
{
   $(this).fadeIn("fast");
}

function fadeOut()
{
   $(this).fadeOut("fast");
}

